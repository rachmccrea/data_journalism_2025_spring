---
title: "data_analysis"
author: "Rachel McCrea"
date: "2025-04-25"
output: html_document
---
```{r load-packages}
options(scipen=999)
library(tidyverse)  
library(knitr)      
library(lubridate) 
library(janitor)
library(ggplot2)
library(ggrepel)
```

```{r}
detail_sod <- read_csv("detail_sod.csv")
```
#fixing dates
```{r}
detail_sod <- detail_sod %>% 
  mutate(TRANSACTION_DATE=dmy(TRANSACTION_DATE))
```
```{r}
 detail_sod <- detail_sod %>% 
  mutate(PERFORM_START_DT=dmy(PERFORM_START_DT))
```
```{r}
detail_sod <- detail_sod %>% 
  mutate(PERFORM_END_DT=dmy(PERFORM_END_DT))
```
```{r}
write_csv(detail_sod, "detail_sod_clean.csv")
```


```{r}
detail_sod_clean <- read_csv("detail_sod_clean.csv")

glimpse(detail_sod_clean)
```
129,843 rows, 18 columns including dates of transactions, which office spent the money, the description of the transaction, and the amount. 
Limitations/flaws: No party column, which would have been handy if we wanted to look at differences in spending between parties. I bet it's also hard to group by "description" because there are so many different kinds of spending listed, and "legislative planning food and beverage" is different from "food and beverage". The limited timeframe could also be an issue. 

```{r}
summary_sod <- read_csv("summary_sod.csv")

glimpse(summary_sod)
```
6676 rows and five columns: organization, program, description, year-to-date amount, and quarter-to-date amount. 
Similar limitations/flaws to the detailed one: timeframe, lots of different categories for "description," no party identifier. I was also seeing some negative numbers in the amounts columns which is weird. 



4/30 

```{r}
summary_sod <- read_csv("summary_sod.csv")

grouped_by_org <- summary_sod %>% 
  group_by(ORGANIZATION) %>% 
  summarize(sum = sum(YTD_AMOUNT)) %>% 
  arrange(desc(sum))

grouped_by_org %>% 
  clean_names()


#ok let's figure out a bar chart 
#there's toooo many reps so I'm gonna do the five highest spenders and five lowest spenders, not including House leadership

highest_lowest_spenders <- grouped_by_org %>% 
  filter(ORGANIZATION %in% c('2024 HON. JENNIFFER GONZALEZ-COLON','2024 HON. ALEXANDER X. MOONEY','2024 HON. MATT CARTWRIGHT','2024 HON. JEFFERSON VAN DREW','2024 HON. ADAM B. SCHIFF','2024 HON. TONY WIED','2024 HON. 3RD DISTRICT OF NEW YORK','2024 HON. ERICA LEE CARTER','2024 HON. LAMONICA MCIVER','2024 HON. BRIAN HIGGINS'))

#mira helped figure out the filtering using the c() stuff!

highest_lowest_spenders %>% 
  ggplot() + 
  geom_bar(aes(x = ORGANIZATION, weight = sum)) +
  theme(
    element_text(angle = 45)) 
  
#can't get the bar labels to go at an angle. consulting chat. 
#here's what chat says: 
#highest_lowest_spenders %>% 
 # ggplot() + 
 # geom_bar(aes(x = ORGANIZATION, weight = sum)) +
 # theme(
   # axis.text.x = element_text(angle = 45, hjust = 1)
 # )

highest_lowest_spenders %>% 
  ggplot() + 
  geom_bar(aes(x = ORGANIZATION, weight = sum)) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

#THAT WORKED THANKS CHAT!

highest_lowest_spenders %>% 
  ggplot() + 
  geom_bar(aes(x = ORGANIZATION, weight = sum)) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)
  ) +
  labs(
    title="Highest vs. Lowest-Spending Represenatives", 
    x="Representative Offices",
    y="Spending"
  )





```




